var U1A5,bind=function(a,b){return function(){return a.apply(b,arguments)}},extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;U1A5=function(a){function b(){this.finish=bind(this.finish,this),this.finishEvaluation=bind(this.finishEvaluation,this),this.evaluateAnswer=bind(this.evaluateAnswer,this),this.initEvaluation=bind(this.initEvaluation,this);var a,c;a=[{id:"head",src:"pleca1.png"},{id:"c1",src:"circle1.png"},{id:"c2",src:"circle2.png"},{id:"repeatbtn",src:"repeat-btn.png"},{id:"playagain",src:"play_again.png"},{id:"startgame",src:"start_game.png"},{id:"bg",src:"bg.png"},{id:"1",src:"1.png"},{id:"2",src:"2.png"},{id:"3",src:"3.png"},{id:"4",src:"4.png"},{id:"1b",src:"1.png"},{id:"2b",src:"2b.png"},{id:"3b",src:"3b.png"},{id:"4b",src:"4b.png"},{id:"2p1",src:"2p1.png"},{id:"2p2",src:"2p2.png"},{id:"3p1",src:"3p1.png"},{id:"3p2",src:"3p2.png"}],c=[{src:"sounds/good.mp3",id:"good"},{src:"sounds/wrong.mp3",id:"wrong"},{src:"sounds/TU3_U1_A5_instructions.mp3",id:"instructions"},{src:"sounds/TU3_U1_A5_scene1.mp3",id:"scene1"}],this.game=[{texts:[{idx:3,t:"Follow me,",p:"p1"},{idx:3,t:"It's the Magic Rain Book.",p:"p2"},{idx:2,t:"We're looking for a book about rain,",p:"p2"},{idx:2,t:"Are you looking for a particular book?",p:"p1"},{idx:4,t:"Thank you,"}],positions:[{x:250,y:370},{x:250,y:540},{x:250,y:640},{x:825,y:280}]}],this.answers=[],b.__super__.constructor.call(this,null,a,c)}return extend(b,a),b.prototype.setStage=function(){return b.__super__.setStage.apply(this,arguments),this.intento=0,this.insertBitmap("header","head",stageSize.w/2,0,"tc"),this.insertInstructions("instructions",["Listen, read and drag the dialogues to the text."],80,180),this.addToMain(new Score("score",this.preload.getResult("c1"),this.preload.getResult("c2"),0,1e3,5,0)),this.library.score.txtCount.color="#bfd951",this.library.score.txtTotal.color="#ff9933",this.setCuento(1).introEvaluation()},b.prototype.setCuento=function(a){var b,c,d,e,f,g,h,i,j,k;for(c=new createjs.Container,c.name="cuento",this.scene=a,b=this.createBitmap("bg","bg",0,130),b.scaleX=b.scaleY=.98,c.addChild(b),e=f=1,i=this.game[a-1].positions.length;i>=f;e=f+=1)h=1===e?this.createSprite("sc"+e,[4*(a-1)+e+"b"],null,this.game[a-1].positions[e-1].x,this.game[a-1].positions[e-1].y):4===e?this.createSprite("sc"+e,[""+(4*(a-1)+e),4*(a-1)+e+"b"],null,this.game[a-1].positions[e-1].x,this.game[a-1].positions[e-1].y):this.createSprite("sc"+e,[""+(4*(a-1)+e),4*(a-1)+e+"p1",4*(a-1)+e+"p2",4*(a-1)+e+"b"],null,this.game[a-1].positions[e-1].x,this.game[a-1].positions[e-1].y),d=new createjs.Shape,d.graphics.beginFill("rgba(255, 255, 255, 0.1)").drawRect(0,0,h.width,h.height),d.name="hsc"+e,d.x=this.game[a-1].positions[e-1].x,d.y=this.game[a-1].positions[e-1].y,d.index=4*(a-1)+e,c.addChild(d,h),this.addToLibrary(d,h);for(e=g=1,j=this.game[a-1].texts.length;j>=g;e=g+=1)k=new DraggableText("t"+e,this.game[a-1].texts[e-1].t,this.game[a-1].texts[e-1].idx,1350,60*e+750),k.text.textAlign="center",k.setHitArea(),this.game[a-1].texts[e-1].p&&(k.p=this.game[a-1].texts[e-1].p),this.addToLibrary(k),c.addChild(k);return this.addToMain(c),this},b.prototype.introEvaluation=function(){var a,c,d;for(b.__super__.introEvaluation.apply(this,arguments),a=c=1,d=this.game[this.scene-1].texts.length;d>=c;a=c+=1)this.observer.subscribe("init_evaluation",this.library["t"+a].onInitEvaluation);return TweenLite.from(this.library.header,1,{y:-this.library.header.height}),TweenLite.from(this.library.instructions,1,{alpha:0,x:0,delay:.5}),TweenLite.from(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+20,delay:1,onComplete:this.playInstructions,onCompleteParams:[this]})},b.prototype.initEvaluation=function(a){var c,d,e,f;for(b.__super__.initEvaluation.apply(this,arguments),createjs.Sound.play("scene"+this.scene),f=[],c=d=1,e=this.game[this.scene-1].texts.length;e>=d;c=d+=1)f.push(this.library["t"+c].addEventListener("click",this.evaluateAnswer));return f},b.prototype.evaluateAnswer=function(a){var b,c,d,e,f,g,h;for(this.answer=a.currentTarget,b=!1,h=[],c=d=1,f=this.game[this.scene-1].positions.length;f>=d;c=d+=1)e=this.library["hsc"+c].globalToLocal(this.stage.mouseX,this.stage.mouseY),this.library["hsc"+c].hitTest(e.x,e.y)?this.answer.index===this.library["hsc"+c].index?(this.library["sc"+c].animation.gotoAndStop(this.answer.p?1===(g=this.library["sc"+c].animation.currentFrame)||2===g?3:"p1"===this.answer.p?1:2:1),this.answer.visible=!1,createjs.Sound.play("good"),0===this.intento&&this.library.score.plusOne(),this.intento=0,h.push(this.finishEvaluation())):(this.intento=1,this.warning(),h.push(this.answer.returnToPlace())):h.push(this.answer.returnToPlace());return h},b.prototype.finishEvaluation=function(){var a,b,c;for(a=b=1,c=this.game[this.scene-1].positions.length;c>=b;a=b+=1)if(this.library["sc"+a].animation.currentFrame!==this.library["sc"+a].animation.spriteSheet._frames.length-1)return;return setTimeout(this.finish,3e3)},b.prototype.finish=function(){return createjs.Sound.stop(),TweenLite.to(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+10}),b.__super__.finish.apply(this,arguments)},window.U1A5=b,b}(Oda);